<!DOCTYPE html>
<html>
<body>

<h1>Delimiter-matching</h1>

<textarea id="textBox" name="Text1" cols="100" rows="30" placeholder="Copy and paste your code here"></textarea>
<input type="button" value="Check!" />
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>

<script>

var lineCount = 1; // Used to find the location of the problem
var myArray = []; // Array that only holds opening braces (stack data structure)

// Returns opposite delimiters
var oppositeDelimiter = function(ch)
{
    switch (ch)
    {
        case '(':
            return ')';
        case '[':
            return ']';
        case '{':
            return '}';
        default:
            break;
    }
};

// Only opening braces are pushed to the array
var pushDelimiter = function(ch)
{
    switch (ch)
    {
        case '(':
        case '[':
        case '{':
            myArray.push(ch);
            break;
    }
};

// Analyzes the code. If there is a problem, it tells the user the location of the problem and the problem itself
// Using textarea to take user input and read line by line
$('input[type=button]').click(function () 
{
    var line = "";
    var text = $('#textBox').val().split('\n');

    for (var i = 0; i < text.length; i++)
    {
        line = text[i];
        for (var j = 0; j < line.length; j++)
        {
            pushDelimiter(line[j]);
            switch (line[j])
            {
                case ')':
                case ']':
                case '}':
                    if (myArray.length !== 0)
                    {
                        var topBracket = myArray.pop();
                        if (line[j] !== oppositeDelimiter(topBracket)) // Closing brace does not match the most recent opening brace
                        {
                            console.log("Line " + lineCount + ": expected " + oppositeDelimiter(topBracket) + ", but found " + line[j] + ".");
                            return;
                        }
                    }
                    else // Array is empty but the program encounters a closing brace
                    {
                        console.log("Line " + lineCount + ": extraneous closing brace " + line[j] + ".");
                        return false;
                    }
                    break;
                default:
                    break;
            }
        }
        lineCount++;
    }
    if (myArray.length !== 0) // Reached end of code but the array is not empty
    {
        console.log("Reached end of code: missing " + oppositeDelimiter(myArray[myArray.length - 1]) + ".");
    }
    else if (myArray.length === 0) // Reached end of code and the array is empty
    {
        console.log("Delimiters in the code are matched.");
    }
});

</script>
</body>
</html>
